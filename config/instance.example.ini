; -----------------------------------------------------------------------------
; MainsBot multi-instance config (INI) - FULL EXAMPLE
;
; Copy this file to: config/<instance>.ini
; Run: node main.js --config config/<instance>.ini
;
; Goal: only edit THIS ini after download.
; - Recommended: use the structured sections ([twitch], [spotify], [roblox], etc)
; - Advanced/legacy overrides: any raw env vars can still go in [env]
;
; Twitch dev console redirect URIs (single callback recommended):
; - https://YOUR_DOMAIN/auth/callback         (web admin login + bot/streamer OAuth)
;
; Roblox dev console redirect URI:
; - https://YOUR_DOMAIN/auth/roblox/callback
; -----------------------------------------------------------------------------

[instance]
; Unique name per streamer/bot instance (also used as DB instance key).
name = example
   
; Per-instance runtime state lives here (SETTINGS.json / STREAMS.json / playtime.json, etc).
; bootstrap auto-seeds SETTINGS/STREAMS/playtime if missing.
data_dir = ./data/example

; Optional secrets JSON (NOT required):
; [secrets]
; path = ./secrets/instance.example.json

[paths]
; Per-instance OAuth token stores (JSON). Tokens stay JSON (by design).
twitch_token_store = ./data/example/secrets/twitch_tokens.json
roblox_token_store = ./data/example/secrets/roblox_tokens.json
spotify_token_store = ./data/example/secrets/spotify_tokens.json
; Optional: override keyword file path (default: ./data/<instance>/d/words.json)
; words_path = ./data/example/d/words.json

[state]
; file (default) or postgres
backend = postgres

[web]
; Admin auth mode:
; - password: simple username/password login (recommended for local dev)
; - twitch: Twitch OAuth login (legacy)
auth_mode = password

; Used when auth_mode=password
; NOTE: storing a plaintext password in INI is OK for local dev, but not ideal for production.
; You can instead set admin_password_hash = sha256:<hex>
admin_username = admin
admin_password =
; admin_password_hash = sha256:

; Listen mode: auto (default), tcp, or socket
; - auto: use socket_path if set, otherwise host+port
; - tcp: always use host+port
; - socket: always use socket_path
listen = auto

; Prefer unix socket behind nginx (Linux).
; socket_path = /run/mainsbot-example.sock

; Windows named pipe example:
; socket_path = \\\\.\\pipe\\mainsbot-example

; Used when socket_path is blank or listen=tcp.
host = 127.0.0.1
port = 8787

; Local dev origins (optional). Helps Twitch show localhost instead of your real domain.
; origin = http://127.0.0.1:8787
; admin_origin = http://127.0.0.1:8787
; admin_redirect_uri = http://127.0.0.1:8787/auth/callback
; public_url = https://example.com
; Optional: moderator cache file used by web login fallback
; mods_cache_path = ./data/example/d/channel_mods.json

; If 1, forces Twitch to prompt login even if you're already logged in.
login_force_verify = 0

; IP intel / VPN detection for web-triggered Spotify actions (Discord audit logs).
; Uses ip-api.com and prefers the real client IP from proxy headers.
; Set to 0 to disable external lookup.
ip_intel_enabled = 1
; Request timeout for IP intel lookups.
ip_intel_timeout_ms = 2500
; Cache duration per IP.
ip_intel_cache_ms = 21600000

; Admin allowlist for /admin + /auth/*
; cookie_secret is required for login sessions.
cookie_secret = change_me_to_a_long_random_string
owner_user_id =
owner_login = your_twitch_login
allowed_users = your_twitch_login,another_allowed_login

[modules]
; 1 = enabled, 0 = disabled
; For getting now playing adding songs etc..
spotify = 1
; For roblox presense, playtime, and games played
roblox = 1
; for using game ping command (opt)
discord = 1
gameping = 1
; for pubsub listener
pubsub = 1
; for twitch subs/bits/raid + streamlabs donations
alerts = 1
; Tab manager (!tab / !givetab / !addtab / !settab)
tab = 0
; Custom commands with Pajbot-style variables (DB-backed)
custom_commands = 0

[link]
; 0 = disabled, 1 = manage !link via Fossabot/Nightbot, 2 = bot handles !link itself
mode = 1

; provider is only used when mode=1
; fossabot or nightbot
provider = fossabot

; command name to manage/serve
command_name = !link

; Optional, used in link messages (PC/mobile join help)
mobile_howto_url = https://youtu.be/MJJ89F_DzEE

; Optional: command (default) or direct
; - command: responses say "type !link"
; - direct: responses include the link directly (requires currentLink to be set)
reply_style = direct

[settings]
; 1 = bot messages use the [ðŸ¤–] prefix, 0 = no prefix
is_bot = 0

; Optional legacy admin id (web owner/permitted is configured in [web])
admin_id =

; Discord-only !time command timezone.
; Supports common short names (EST/CST/MST/PST) or IANA (America/New_York).
timezone = EST

[messages]
; Optional lifecycle chat messages.
; Sent when the bot connects on startup and during graceful shutdown.
; Supported placeholders: {channel}, {channel_display}, {instance}, {signal}
startup = ðŸ¤– {channel_display} bot is now online.
shutdown = ðŸ¤– {channel_display} bot is shutting down ({signal}).

[database]
; Required when [state].backend=postgres
url = postgresql://mainsbot@127.0.0.1:5432/mainsbot
; Optional: separate schema per instance, e.g. mainsbot_example
schema = mainsbot_example
sslmode =

[twitch]
; Basics (optional if your token store already has bot+streamer records)
bot_name =
bot_id =
channel_name =
channel_id =
channel_name_display =

; Optional legacy IRC tokens (NOT recommended; prefer token store JSON via /admin OAuth)
; bot_token =
; bot_oauth =
; streamer_token =

; Twitch app (required for /admin login + /auth/* OAuth)
client_id =
client_secret =

; OAuth redirect (must match your Twitch app allowlist)
auth_redirect_uri = https://example.com/auth/callback
auth_force_verify = 1
auth_dynamic_redirect = 0

; Chat transport (Helix first, optional IRC fallback)
chat_use_helix = 1
chat_allow_irc_fallback = 0
; If 1, uses an App Access Token for Helix chat sends (recommended to get Twitch's bot badge).
; Requires [twitch].client_id + client_secret, and that you've linked bot+streamer via /auth.
chat_use_app_token = 1

[roblox]
; Optional (only needed if you want Roblox OAuth linking)
client_id =
client_secret =
; Legacy cookie fallback (required for some older Roblox endpoints, e.g. friend requests)
cookie =
auth_redirect_uri = https://example.com/auth/roblox/callback
auth_scopes = openid profile
auth_force_verify = 0
auth_dynamic_redirect = 0

[spotify]
; Optional (only needed when [modules].spotify=1)
client_id =
client_secret =
; Spotify OAuth redirect (must match Spotify app allowlist)
; - https://example.com/auth/callback
auth_redirect_uri = https://example.com/auth/callback
auth_dynamic_redirect = 0

; Legacy fallback (not recommended): you can paste a refresh token directly.
; refresh_token =

[discord]
; Optional (only needed when [modules].discord=1)
webhook_url =
guild_id =
bot_token =
; Prefer using the bot account to send announcements/logs (instead of webhooks).
; If set, game pings + logs will send to these channels using the bot token.
channel_id =
announce_channel_id =
log_channel_id =
; Optional: allow running Twitch chat commands from Discord (relay).
; Requires enabling "Message Content Intent" for your bot in the Discord developer portal.
commands_enabled = 0
; Comma-separated Discord channel ids that accept commands (ex: 123,456)
; If blank and commands_enabled=1, relay is enabled for ALL channels in the guild.
command_channel_ids =
; Comma-separated Discord role ids required for mod-only commands
mod_role_ids =
; Relay mode: simulate only (runs commands by simulating a Twitch chat message)
relay_mode = simulate
relay_debug = 0

  ; Optional: Twitch chat -> Discord embed logs (batched)
  ; Sends chat logs to twitch_chat_log_channel_id (or log_channel_id if blank).
  twitch_chat_log_enabled = 0
  ; If 1, only logs messages starting with "!" (commands).
  twitch_chat_log_commands_only = 0
  ; Mode:
  ; - batch (default): groups multiple lines into one embed
  ; - per_message: one embed per chat message (cleaner, more spammy)
  twitch_chat_log_mode = batch
  twitch_chat_log_flush_ms = 2500
  twitch_chat_log_max_lines = 12
  twitch_chat_log_channel_id =

[streamlabs]
; Optional (only needed when [modules].alerts=1 and you want Streamlabs donations)
socket_token =

[gameping]
; Optional (only needed when [modules].gameping=1)
; Where to store the dumped Discord role map (recommended: per-instance data dir).
; Default is `DATA_DIR/game_pings.json` if blank.
roles_path =

; Allowlist of Twitch logins (in addition to mods/broadcaster/owner) that can run !gameping
allowed_users =

; If 1, dumps ping roles from Discord on startup (requires [discord].bot_token + [discord].guild_id)
; Modes:
; - missing (default): only dump when roles_path is missing
; - stale: dump when older than stale_hours
; - always: dump every startup
auto_dump_roles = 0
dump_mode = missing
stale_hours = 24

; Comma-separated role names to ignore (in addition to "Anti Ghost Ping")
exclude_roles =

[env]
; Advanced / legacy: any raw env var overrides go here.
; Examples:
; WAIT_REGISTER = 300000
; COOLDOWN = 90000
; TWITCH_CHAT_ALLOW_IRC_FALLBACK = 0
